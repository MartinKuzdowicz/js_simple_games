<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8" \>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous" />

<title>Black Jack - cards game</title>

<style>

#blackJackMain {
	background-color: #ddd;
	width: 100%;
	margin: 0 auto;
}
	
ul.cardsUL {
  margin: 0 auto;
  margin-top: 1%;
  padding: 0;
  width: 1150px;
}

ul.cardsUL li {
  list-style: none;
  display: inline-block;
  margin-left: 5px;
  margin-bottom: 5px;
}

#dropZone{
	width: 300px;
	height: 300px;
	background-color: green;
	border: 1px dotted black;
	margin: 0 auto;
	padding-top: 5%;
}

#status {
	width: 300px;
	height: 80px;
	background-color: snow;
	border: 1px solid black;
	margin: 0 auto;
	padding: 1%;
}

#round {
	width: 100px;
	height: 60px;
	margin: 1% auto 0 auto;
	padding: 1%;
	background-color: brown;
	color: white;
}

.card {
	width: 65px;
}

.cardInDropeZone {

	width: 120px;

}

#humanCardsDiv {

	margin-bottom: 5%;

}

.playerTitle {
	margin-top: 1%;
}

.playerTitle p {
	border-radius: 6px;
}

</style>
	
</head>	
<body>

	<div id="blackJackMain" class="container">
		
		<h1 class="text-center text-uppercase">Black Jack - cards game</h1>

		<div id="status">drop count: 0 <br /> points: 0 </div>
		<div id="round">round: <br />human</div>

		<div id="computerCardsDiv">
		<div class="row playerTitle">
			<p class="col-md-offset-2 bg-primary col-md-3 text-center"><strong>Computer</strong></p>
		</div>
			<ul class="cardsUL text-center" id="compCardsUL"></ul>
		</div>
		<br />
		<br />
		<div id="dropZone" class="text-center"></div>


		<div id="humanCardsDiv">
		<div class="row playerTitle">
			<p class="col-md-offset-2 bg-primary col-md-3 text-center"><strong>Human</strong></p>
		</div>
			<ul class="cardsUL text-center" id="humCardsUL"></ul>
		</div>

	</div>

<!-- imoprt cards -->
<script src="cardsDB.js"></script>

<script>

// global vars ------------------------------------------

var droppedCardsStack = [];

var darggedElId;

var droppedObject;

var dropCounter = 0;

var points = 0;

var compCardsList = [];

var humCardsList = [];

var palyers = ['human', 'computer'];

var round = palyers[0];

// main ----------------------------------------------------

window.onload = function() {


	var dropZone = document.getElementById('dropZone');

	initComputerCards();

	initHumanCards();

	dropZone.addEventListener("dragover", dragover, false);

	dropZone.addEventListener("drop", drop, false);

};

// functions ---------------------------------------------------

function swapRound() {

	var roundDiv = document.getElementById('round');

	if(dropCounter % 2 == 0) {
		round = palyers[0];

	} else {
		round = palyers[1];
	}

	roundDiv.innerHTML = "round: <br />" + round;

}

function initComputerCards() {

	populateComputerCardsList();

	var compCardsUL = document.getElementById('compCardsUL');

	for(var i = 0; i < compCardsList.length; i++) {

		var li = document.createElement('LI');
		var img = document.createElement('IMG');
		var tempCard = compCardsList[i];
		img.src = tempCard.imgSrc;
		img.id = tempCard.key;
		img.className = 'card';

		img.addEventListener("dragstart", drag, false);

		li.appendChild(img);
		compCardsUL.appendChild(li);

	}

}


function initHumanCards() {

	populateHumanCardsList();

	var humCardsUL = document.getElementById('humCardsUL');

	for(var i = 0; i < humCardsList.length; i++) {

		var li = document.createElement('LI');
		var img = document.createElement('IMG');
		var tempCard = humCardsList[i];
		img.src = tempCard.imgSrc;
		img.id = tempCard.key;
		img.className = 'card';

		img.addEventListener("dragstart", drag, false);

		li.appendChild(img);
		humCardsUL.appendChild(li);

	}

}


function populateHumanCardsList() {

	var counter = 0;

	for(var key in cards) {

		if(counter % 2 == 0) {
			humCardsList.push(cards[key]);
		}

		counter++;

	}

}


function populateComputerCardsList() {

	var counter = 0;

	for(var key in cards) {

		if(counter % 2 != 0) {
			compCardsList.push(cards[key]);
		}

		counter++;

	}

}


function drag(e) {

	darggedElId = e.target.id;

}

function dragover(e) {

	e.preventDefault();

}

function drop(e){

	e.preventDefault();

	performGameLogic();
	swapRound();

	
	}

	function removeCardFromPalyersCards(player, card) {

		if(player == palyers[0]) {

			for(var i = 0; i < humCardsList.length; i++) {

				if(humCardsList[i].key == card.key) {
					humCardsList.splice(i, 1);
				}

			}

		} else {

			for(var i = 0; i < compCardsList.length; i++) {

				if(compCardsList[i].key == card.key) {
					compCardsList.splice(i, 1);
				}

			}

		}


	}

function performGameLogic() {

	var dropZone = document.getElementById('dropZone');

	var actualCardInDropZoneObj = droppedObject;

	var newDroppedCard = cards[darggedElId];

	var gameStatus = document.getElementById('status');

	var statusMsg;


	var Strategy = {

		firstTime: function() {

							// set object
							droppedObject = cards[darggedElId];
							// add to stack
							droppedCardsStack.push(droppedObject);

							var newCardNode = document.getElementById(darggedElId);

							dropZone.appendChild(newCardNode);
							// larger image
							newCardNode.className = 'cardInDropeZone';

							dropCounter++;

							statusMsg = 'drop count: ' + dropCounter + '<br />' 
									+ droppedObject.name + ' is in drop zone' 
									+ '<br /> points: ' +points;
								
							gameStatus.innerHTML = statusMsg;

							// update palyers cards list
							removeCardFromPalyersCards(round, droppedObject);
								
						},

		isGreater : function() {
							// delete preview card
							dropZone.innerHTML = '';
							// move new
							var newCardNode = document.getElementById(darggedElId);
							dropZone.appendChild(newCardNode);
							// larger image
							newCardNode.className = 'cardInDropeZone';
							// swap global var for actual card in playground
							droppedObject = newDroppedCard;
							// add to stack
							droppedCardsStack.push(droppedObject);

							dropCounter++;
							points++;

							statusMsg = 'drop count: ' + dropCounter + 
								'<br />' + newDroppedCard.name + 
								' is in drop zone' + '<br /> points: ' +points;
							// update status msg	
							gameStatus.innerHTML = statusMsg;

							// update palyers cards list
							removeCardFromPalyersCards(round, droppedObject);

						},
		isEqual : function() {alert(newDroppedCard.name + ' is equal to ' + actualCardInDropZoneObj.name + ', choose greater card');},
		isLess : function() { alert(newDroppedCard.name + ' is less then ' + actualCardInDropZoneObj.name + ', choose greater card');}

	}


	if(dropCounter == 0) {

		Strategy.firstTime();
		return;

	} 

	if (newDroppedCard.gameVal > actualCardInDropZoneObj.gameVal) {

		Strategy.isGreater();
		return;
	} 

	if(newDroppedCard.gameVal == actualCardInDropZoneObj.gameVal) {

		Strategy.isEqual();
		return;
	} 

	if(newDroppedCard.gameVal < actualCardInDropZoneObj.gameVal) {

		Strategy.isLess();
		return;
	} 


}



</script>

</body>
</html>